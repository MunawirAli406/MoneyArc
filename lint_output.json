[{"filePath":"M:\\Projects\\MoneyArc\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\components\\layout\\GoToSearch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\components\\layout\\Header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\components\\layout\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\components\\layout\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\accounting\\masters\\LedgerForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\accounting\\masters\\LedgerList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\accounting\\reports\\Daybook.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\accounting\\vouchers\\InvoiceModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\accounting\\vouchers\\VoucherEntry.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\auth\\AuthContext.provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\auth\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\auth\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\auth\\SignUpPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\auth\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\dashboard\\Dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\StockGroupForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\StockGroupList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\StockItemForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\StockItemList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\StockSummary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\UnitForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\inventory\\UnitList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\onboarding\\CompanySelect.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadCompanies'. Either include it or remove the dependency array.","line":44,"column":8,"nodeType":"ArrayExpression","endLine":44,"endColumn":58,"suggestions":[{"desc":"Update the dependencies array to be: [provider, isLoading, initializeStorage, navigate, loadCompanies]","fix":{"range":[1873,1923],"text":"[provider, isLoading, initializeStorage, navigate, loadCompanies]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Building2, Plus, Search, Calendar, ChevronRight, Loader2 } from 'lucide-react';\r\nimport { usePersistence } from '../../services/persistence/PersistenceContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport type { Company } from '../../services/persistence/types';\r\n\r\nexport default function CompanySelect() {\r\n    const { provider, selectCompany, initializeStorage } = usePersistence();\r\n    const [companies, setCompanies] = useState<Company[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [showCreateForm, setShowCreateForm] = useState(false);\r\n    const [editingCompanyId, setEditingCompanyId] = useState<string | null>(null);\r\n    const [newCompany, setNewCompany] = useState<Omit<Company, 'id' | 'path'>>({\r\n        name: '',\r\n        financialYear: '2025-26',\r\n        gstin: '',\r\n        address: '',\r\n        state: 'Maharashtra',\r\n        country: 'India',\r\n        phone: '',\r\n        email: '',\r\n        website: '',\r\n        currency: 'INR',\r\n        symbol: '₹',\r\n        registrationType: 'Regular'\r\n    });\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        if (!provider) {\r\n            // If provider is not set, try to initialize storage if not already loading\r\n            if (!isLoading) {\r\n                initializeStorage('local').catch(console.error);\r\n            }\r\n            // If still no provider after attempt, navigate to select-source\r\n            // This check might be redundant if initializeStorage sets provider immediately\r\n            // or if the component re-renders after provider is set.\r\n            // For now, keeping the original navigation logic.\r\n            navigate('/select-source');\r\n            return;\r\n        }\r\n        loadCompanies();\r\n    }, [provider, isLoading, initializeStorage, navigate]);\r\n\r\n    const loadCompanies = async () => {\r\n        if (!provider) return;\r\n        setIsLoading(true);\r\n        try {\r\n            const list = await provider.listCompanies();\r\n            setCompanies(list);\r\n        } catch (error) {\r\n            console.error(\"Failed to load companies\", error);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleSelect = (company: Company) => {\r\n        selectCompany(company);\r\n        navigate('/dashboard');\r\n    };\r\n\r\n    const handleEdit = (company: Company) => {\r\n        setNewCompany({\r\n            name: company.name,\r\n            financialYear: company.financialYear,\r\n            gstin: company.gstin || '',\r\n            address: company.address || '',\r\n            state: company.state || '',\r\n            country: company.country || 'India',\r\n            phone: company.phone || '',\r\n            email: company.email || '',\r\n            website: company.website || '',\r\n            currency: company.currency || 'INR',\r\n            symbol: company.symbol || '₹',\r\n            registrationType: company.registrationType || 'Regular'\r\n        });\r\n        setEditingCompanyId(company.id);\r\n        setShowCreateForm(true);\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setNewCompany({\r\n            name: '',\r\n            financialYear: '2025-26',\r\n            gstin: '',\r\n            address: '',\r\n            state: 'Maharashtra',\r\n            country: 'India',\r\n            phone: '',\r\n            email: '',\r\n            website: '',\r\n            currency: 'INR',\r\n            symbol: '₹',\r\n            registrationType: 'Regular'\r\n        });\r\n        setEditingCompanyId(null);\r\n        setShowCreateForm(false);\r\n    };\r\n\r\n    const handleCreate = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!provider) return;\r\n        setIsLoading(true);\r\n        try {\r\n            if (editingCompanyId) {\r\n                const companyToEdit = companies.find(c => c.id === editingCompanyId);\r\n                if (companyToEdit) {\r\n                    await provider.updateCompany(editingCompanyId, companyToEdit.path, newCompany);\r\n                    await loadCompanies();\r\n                    resetForm();\r\n                }\r\n            } else {\r\n                const created = await provider.createCompany(newCompany);\r\n                handleSelect(created);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to save company\", error);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const filteredCompanies = companies.filter(c =>\r\n        c.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\r\n            <div className=\"max-w-4xl w-full\">\r\n                <div className=\"text-center mb-10\">\r\n                    <h1 className=\"text-4xl font-black text-foreground mb-4 tracking-tight uppercase\">Select Company</h1>\r\n                    <p className=\"text-muted-foreground font-medium\">Choose a workspace to manage your financial arc.</p>\r\n                </div>\r\n\r\n                <div className=\"bg-card rounded-3xl shadow-xl overflow-hidden border border-border\">\r\n                    <div className=\"p-8 border-b border-border flex items-center justify-between bg-card/50 backdrop-blur-sm sticky top-0 z-10\">\r\n                        <div className=\"relative flex-1 max-w-md\">\r\n                            <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground w-5 h-5\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Search companies...\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                className=\"w-full pl-12 pr-4 py-3 bg-muted/30 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-medium\"\r\n                            />\r\n                        </div>\r\n                        <button\r\n                            onClick={() => setShowCreateForm(true)}\r\n                            className=\"ml-6 flex items-center gap-2 bg-primary text-primary-foreground px-6 py-3 rounded-2xl font-black uppercase tracking-widest text-xs hover:shadow-lg hover:shadow-primary/20 transition-all active:scale-95\"\r\n                        >\r\n                            <Plus className=\"w-5 h-5\" />\r\n                            New Company\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"divide-y divide-border/50 max-h-[500px] overflow-y-auto\">\r\n                        {isLoading ? (\r\n                            <div className=\"py-24 flex flex-col items-center justify-center text-muted-foreground\">\r\n                                <Loader2 className=\"w-12 h-12 animate-spin text-primary mb-6\" />\r\n                                <p className=\"font-bold uppercase tracking-widest text-xs\">Accessing Ledgers...</p>\r\n                            </div>\r\n                        ) : filteredCompanies.length > 0 ? (\r\n                            filteredCompanies.map((company) => (\r\n                                <button\r\n                                    key={company.id}\r\n                                    onClick={() => handleSelect(company)}\r\n                                    className=\"w-full p-8 flex items-center justify-between hover:bg-muted/30 transition-all text-left group\"\r\n                                >\r\n                                    <div className=\"flex items-center gap-6\">\r\n                                        <div className=\"w-16 h-16 bg-primary/10 rounded-2xl flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-primary-foreground transition-all duration-300\">\r\n                                            <Building2 className=\"w-8 h-8\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <h3 className=\"text-xl font-black text-foreground group-hover:text-primary transition-colors tracking-tight\">\r\n                                                {company.name}\r\n                                            </h3>\r\n                                            <div className=\"flex items-center gap-4 text-xs font-bold text-muted-foreground mt-2 uppercase tracking-widest\">\r\n                                                <span className=\"flex items-center gap-1.5\">\r\n                                                    <Calendar className=\"w-4 h-4\" />\r\n                                                    FY: {company.financialYear}\r\n                                                </span>\r\n                                                <span className=\"w-1.5 h-1.5 bg-border rounded-full\"></span>\r\n                                                <span>GSTIN: {company.gstin || 'UNREGISTERED'}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <div className=\"text-right hidden sm:block\">\r\n                                            <p className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground\">Active State</p>\r\n                                            <p className=\"text-sm font-bold text-foreground\">{company.state || 'N/A'}</p>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={(e) => {\r\n                                                e.stopPropagation();\r\n                                                handleEdit(company);\r\n                                            }}\r\n                                            className=\"p-2 text-muted-foreground hover:text-primary hover:bg-primary/10 rounded-xl transition-all\"\r\n                                        >\r\n                                            <Building2 className=\"w-5 h-5\" />\r\n                                        </button>\r\n                                        <ChevronRight className=\"w-8 h-8 text-border group-hover:text-primary group-hover:translate-x-1 transition-all\" />\r\n                                    </div>\r\n                                </button>\r\n                            ))\r\n                        ) : (\r\n                            <div className=\"py-32 text-center text-muted-foreground\">\r\n                                <div className=\"w-20 h-20 bg-muted rounded-3xl flex items-center justify-center mx-auto mb-6\">\r\n                                    <Building2 className=\"w-10 h-10\" />\r\n                                </div>\r\n                                <p className=\"text-xl font-black text-foreground mb-2\">No Companies Found</p>\r\n                                <p className=\"text-sm font-medium\">Initialize a new company to begin your accounting arc.</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Create Company Modal */}\r\n            {showCreateForm && (\r\n                <div className=\"fixed inset-0 bg-background/80 backdrop-blur-md flex items-center justify-center p-4 z-50 overflow-y-auto\">\r\n                    <div className=\"bg-card rounded-[2.5rem] shadow-2xl w-full max-w-2xl my-8 overflow-hidden animate-in fade-in zoom-in duration-300 border border-border\">\r\n                        <div className=\"p-10 border-b border-border bg-muted/30\">\r\n                            <h2 className=\"text-3xl font-black text-foreground tracking-tight uppercase\">\r\n                                {editingCompanyId ? 'Alter Company' : 'Establish Company'}\r\n                            </h2>\r\n                            <p className=\"font-medium text-muted-foreground mt-1\">\r\n                                {editingCompanyId ? 'Modify your organization details.' : \"Define your organization's core financial identity.\"}\r\n                            </p>\r\n                        </div>\r\n                        <form onSubmit={handleCreate} className=\"p-10 space-y-8\">\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Company Name</label>\r\n                                    <input\r\n                                        required\r\n                                        type=\"text\"\r\n                                        value={newCompany.name}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, name: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                        placeholder=\"e.g., MoneyArc Tech Solutions\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Financial Year</label>\r\n                                    <select\r\n                                        value={newCompany.financialYear}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, financialYear: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground appearance-none\"\r\n                                    >\r\n                                        <option value=\"2024-25\">2024-25</option>\r\n                                        <option value=\"2025-26\">2025-26</option>\r\n                                        <option value=\"2026-27\">2026-27</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">GSTIN Number</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newCompany.gstin}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, gstin: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground uppercase\"\r\n                                        placeholder=\"27AAACR1234A1Z1\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Registration Type</label>\r\n                                    <select\r\n                                        value={newCompany.registrationType}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, registrationType: e.target.value as Company['registrationType'] })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground appearance-none\"\r\n                                    >\r\n                                        <option value=\"Regular\">Regular</option>\r\n                                        <option value=\"Composition\">Composition</option>\r\n                                        <option value=\"Unregistered\">Unregistered</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Country</label>\r\n                                    <input\r\n                                        required\r\n                                        type=\"text\"\r\n                                        value={newCompany.country}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, country: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                        placeholder=\"e.g., India\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">State</label>\r\n                                    <input\r\n                                        required\r\n                                        type=\"text\"\r\n                                        value={newCompany.state}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, state: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                        placeholder=\"e.g., Maharashtra\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Phone</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newCompany.phone}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, phone: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                        placeholder=\"+91 98765 43210\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Email</label>\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        value={newCompany.email}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, email: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                        placeholder=\"contact@company.com\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"md:col-span-2 space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Business Address</label>\r\n                                    <textarea\r\n                                        value={newCompany.address}\r\n                                        onChange={(e) => setNewCompany({ ...newCompany, address: e.target.value })}\r\n                                        className=\"w-full px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground resize-none\"\r\n                                        rows={2}\r\n                                        placeholder=\"Enter full registered address...\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"md:col-span-2 space-y-2\">\r\n                                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Currency & Symbol</label>\r\n                                    <div className=\"flex gap-4\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={newCompany.currency}\r\n                                            onChange={(e) => setNewCompany({ ...newCompany, currency: e.target.value })}\r\n                                            className=\"flex-1 px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                            placeholder=\"Currency (e.g., INR)\"\r\n                                        />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={newCompany.symbol}\r\n                                            onChange={(e) => setNewCompany({ ...newCompany, symbol: e.target.value })}\r\n                                            className=\"w-24 px-5 py-3.5 bg-muted/20 border border-border rounded-2xl focus:ring-2 focus:ring-primary outline-none transition-all font-bold text-foreground\"\r\n                                            placeholder=\"Symbol (₹)\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-4 pt-6\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={resetForm}\r\n                                    className=\"flex-1 px-8 py-4 border border-border rounded-2xl font-black uppercase tracking-widest text-xs text-muted-foreground hover:bg-muted/50 hover:text-foreground transition-all\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isLoading}\r\n                                    className=\"flex-[2] bg-primary text-primary-foreground px-8 py-4 rounded-2xl font-black uppercase tracking-widest text-xs hover:shadow-xl hover:shadow-primary/20 transition-all active:scale-95 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    {isLoading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : (editingCompanyId ? 'Update Workspace' : 'Create Workspace')}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\onboarding\\DataSourceSelect.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\BalanceSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\CashFlow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\FundFlow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\GstReport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\Gstr1Report.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\Gstr3bReport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\ProfitAndLoss.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\reports\\RatioAnalysis.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":109,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":112,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[833,836],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[833,836],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { ArrowLeft, PieChart, TrendingUp, Target, Zap, ShieldCheck } from 'lucide-react';\r\nimport { usePersistence } from '../../services/persistence/PersistenceContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ACCT_GROUPS, type Ledger } from '../../services/accounting/ReportService';\r\nimport type { Voucher } from '../../services/accounting/VoucherService';\r\nimport type { StockItem } from '../../services/inventory/types';\r\n\r\nexport default function RatioAnalysis() {\r\n    const { provider, activeCompany } = usePersistence();\r\n    const navigate = useNavigate();\r\n    const [loading, setLoading] = useState(true);\r\n    const [ratios, setRatios] = useState<{ name: string, value: string, target: string, desc: string, icon: any, color: string, bg: string }[]>([]);\r\n\r\n    useEffect(() => {\r\n        const calculateRatios = async () => {\r\n            if (!provider || !activeCompany) return;\r\n\r\n            const [, lData, sData] = await Promise.all([\r\n                provider.read<Voucher[]>('vouchers.json', activeCompany.path),\r\n                provider.read<Ledger[]>('ledgers.json', activeCompany.path),\r\n                provider.read<StockItem[]>('stock_items.json', activeCompany.path)\r\n            ]);\r\n\r\n            const ledgers = lData || [];\r\n            const stockItems = sData || [];\r\n\r\n            const ca_ledgers = ledgers.filter(l => ACCT_GROUPS.ASSETS.includes(l.group));\r\n            const cl_ledgers = ledgers.filter(l => ACCT_GROUPS.LIABILITIES.includes(l.group));\r\n\r\n            const closingStock = stockItems.reduce((sum, item) => {\r\n                const balance = item.currentBalance !== undefined ? item.currentBalance : item.openingStock;\r\n                const rate = item.currentRate !== undefined ? item.currentRate : item.openingRate;\r\n                return sum + (balance * rate);\r\n            }, 0);\r\n\r\n            const totalCA = ca_ledgers.reduce((sum, l) => sum + l.balance, 0) + closingStock;\r\n            const totalCL = cl_ledgers.reduce((sum, l) => sum + l.balance, 0);\r\n            const quickAssets = totalCA - closingStock;\r\n\r\n            // GP and NP\r\n            const revenue = ledgers.filter(l => ACCT_GROUPS.INCOME.includes(l.group))\r\n                .reduce((sum, l) => sum + l.balance, 0);\r\n            const expenses = ledgers.filter(l => ACCT_GROUPS.EXPENSES.includes(l.group))\r\n                .reduce((sum, l) => sum + l.balance, 0);\r\n\r\n            const netProfit = revenue - expenses;\r\n            const grossProfit = revenue - ledgers.filter(l => l.group === 'Direct Expenses' || l.group === 'Purchase Accounts')\r\n                .reduce((sum, l) => sum + l.balance, 0);\r\n\r\n            setRatios([\r\n                {\r\n                    name: 'Current Ratio',\r\n                    value: totalCL !== 0 ? (totalCA / totalCL).toFixed(2) : 'N/A',\r\n                    target: '2.00',\r\n                    desc: 'Ability to pay short-term obligations',\r\n                    icon: ShieldCheck,\r\n                    color: 'text-cyan-500',\r\n                    bg: 'bg-cyan-500/10'\r\n                },\r\n                {\r\n                    name: 'Quick Ratio',\r\n                    value: totalCL !== 0 ? (quickAssets / totalCL).toFixed(2) : 'N/A',\r\n                    target: '1.00',\r\n                    desc: 'Immediate liquidity position',\r\n                    icon: Zap,\r\n                    color: 'text-amber-500',\r\n                    bg: 'bg-amber-500/10'\r\n                },\r\n                {\r\n                    name: 'GP Margin',\r\n                    value: revenue !== 0 ? ((grossProfit / revenue) * 100).toFixed(2) + '%' : '0%',\r\n                    target: '25%+',\r\n                    desc: 'Profitability from core operations',\r\n                    icon: TrendingUp,\r\n                    color: 'text-emerald-500',\r\n                    bg: 'bg-emerald-500/10'\r\n                },\r\n                {\r\n                    name: 'Net Profit Margin',\r\n                    value: revenue !== 0 ? ((netProfit / revenue) * 100).toFixed(2) + '%' : '0%',\r\n                    target: '15%+',\r\n                    desc: 'Bottom-line efficiency',\r\n                    icon: Target,\r\n                    color: 'text-indigo-500',\r\n                    bg: 'bg-indigo-500/10'\r\n                }\r\n            ]);\r\n            setLoading(false);\r\n        };\r\n        calculateRatios();\r\n    }, [provider, activeCompany]);\r\n\r\n    if (loading) return <div className=\"p-20 text-center font-black uppercase tracking-widest animate-pulse\">Calculating Financial Ratios...</div>;\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            className=\"max-w-6xl mx-auto space-y-8 pb-20\"\r\n        >\r\n            <div className=\"flex items-center gap-4\">\r\n                <button\r\n                    onClick={() => navigate('/dashboard')}\r\n                    className=\"p-3 hover:bg-muted rounded-2xl transition-all\"\r\n                >\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                </button>\r\n                <div>\r\n                    <h1 className=\"text-4xl font-black text-foreground tracking-tight uppercase\">Ratio Analysis</h1>\r\n                    <p className=\"text-muted-foreground font-bold uppercase tracking-widest text-[10px] mt-1\">Financial Performance Health-check</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                {ratios.map((ratio, i) => (\r\n                    <motion.div\r\n                        key={i}\r\n                        whileHover={{ y: -5 }}\r\n                        className=\"bg-card p-10 rounded-[3rem] border border-border shadow-xl space-y-6 relative overflow-hidden group\"\r\n                    >\r\n                        <div className={`absolute top-0 right-0 w-32 h-32 -mr-12 -mt-12 rounded-full ${ratio.bg} blur-3xl opacity-20 group-hover:opacity-40 transition-opacity`} />\r\n                        <div className=\"flex items-center justify-between relative z-10\">\r\n                            <div className={`w-14 h-14 rounded-2xl flex items-center justify-center ${ratio.bg} ${ratio.color}`}>\r\n                                <ratio.icon className=\"w-7 h-7\" />\r\n                            </div>\r\n                            <div className=\"text-right\">\r\n                                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Industry Target</p>\r\n                                <p className=\"text-lg font-black text-foreground\">{ratio.target}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"relative z-10\">\r\n                            <h3 className=\"text-sm font-black uppercase tracking-widest text-muted-foreground\">{ratio.name}</h3>\r\n                            <p className=\"text-5xl font-black mt-2 tracking-tighter\">{ratio.value}</p>\r\n                            <p className=\"text-xs font-bold text-muted-foreground mt-4 italic\">{ratio.desc}</p>\r\n                        </div>\r\n                        <div className=\"pt-6 border-t border-border flex items-center justify-between relative z-10\">\r\n                            <span className=\"text-[9px] font-black uppercase tracking-[0.2em] text-emerald-500 bg-emerald-500/10 px-3 py-1 rounded-full\">Healthy</span>\r\n                            <div className=\"w-24 h-1.5 bg-muted rounded-full overflow-hidden\">\r\n                                <div className=\"w-3/4 h-full bg-primary\" />\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"bg-card rounded-[3rem] border border-border p-10 shadow-sm relative overflow-hidden\">\r\n                <div className=\"flex items-center gap-4 mb-8\">\r\n                    <PieChart className=\"w-6 h-6 text-primary\" />\r\n                    <h2 className=\"text-xl font-black uppercase tracking-tight\">Interpretation & Insights</h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n                    <div className=\"space-y-4\">\r\n                        <h4 className=\"text-[10px] font-black uppercase tracking-widest text-primary\">Liquidity</h4>\r\n                        <p className=\"text-xs font-bold leading-relaxed text-muted-foreground\">The Current Ratio of {ratios[0].value} indicates strong ability to cover short-term liabilities. Ideal range is 1.5 to 2.5.</p>\r\n                    </div>\r\n                    <div className=\"space-y-4\">\r\n                        <h4 className=\"text-[10px] font-black uppercase tracking-widest text-emerald-500\">Operation</h4>\r\n                        <p className=\"text-xs font-bold leading-relaxed text-muted-foreground\">GP Margin remains stable. Efforts to reduce direct material costs could further optimize profitability.</p>\r\n                    </div>\r\n                    <div className=\"space-y-4\">\r\n                        <h4 className=\"text-[10px] font-black uppercase tracking-widest text-indigo-500\">Stability</h4>\r\n                        <p className=\"text-xs font-bold leading-relaxed text-muted-foreground\">Long-term debt is negligible, suggesting a low-risk financial structure and high owner equity.</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\security\\AuditLogViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\settings\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\settings\\ThemeContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\features\\settings\\useTheme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\accounting\\ReportService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\accounting\\VoucherService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\inventory\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\persistence\\FileSystemProvider.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":42,"column":17,"severity":1,"nodeType":null,"fix":{"range":[1448,1510],"text":" "}}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[593,596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[593,596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1690,1693],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1690,1693],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2618,2621],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2618,2621],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5752,5755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5752,5755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import { get, set } from 'idb-keyval';\r\nimport type { StorageProvider, Company } from './types';\r\n\r\nconst HANDLE_KEY = 'moneyarc_dir_handle';\r\n\r\nexport class FileSystemProvider implements StorageProvider {\r\n    private dirHandle: FileSystemDirectoryHandle | null = null;\r\n\r\n    public get isReady(): boolean {\r\n        return this.dirHandle !== null;\r\n    }\r\n\r\n    async init(): Promise<void> {\r\n        try {\r\n            if ('showDirectoryPicker' in window) {\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                this.dirHandle = await (window as any).showDirectoryPicker({\r\n                    mode: 'readwrite',\r\n                    startIn: 'documents',\r\n                });\r\n\r\n                // Persist the handle for next session\r\n                if (this.dirHandle) {\r\n                    await set(HANDLE_KEY, this.dirHandle);\r\n                }\r\n            } else {\r\n                console.error(\"File System Access API not supported\");\r\n            }\r\n        } catch (err) {\r\n            if ((err as Error).name !== 'AbortError') {\r\n                console.error('Error selecting directory:', err);\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n\r\n    async restore(): Promise<boolean> {\r\n        try {\r\n            const savedHandle = await get<FileSystemDirectoryHandle>(HANDLE_KEY);\r\n            if (savedHandle) {\r\n                // Verify permissions\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                const options = { mode: 'readwrite' };\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                if (await (savedHandle as any).queryPermission(options) === 'granted') {\r\n                    this.dirHandle = savedHandle;\r\n                    return true;\r\n                }\r\n\r\n                // If permission is not granted, we might need to request it, \r\n                // but that requires a user gesture. We'll return false and let the context handle it.\r\n            }\r\n        } catch (err) {\r\n            console.warn('Failed to restore directory handle:', err);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    async listCompanies(): Promise<Company[]> {\r\n        if (!this.dirHandle) throw new Error('Storage not initialized');\r\n        const companies: Company[] = [];\r\n\r\n        // In this simple implementation, each subdirectory represents a company\r\n        // We look for a 'company.json' in each subdirectory\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        for await (const entry of (this.dirHandle as any).values()) {\r\n            if (entry.kind === 'directory') {\r\n                try {\r\n                    const compFile = await entry.getFileHandle('company.json');\r\n                    const file = await compFile.getFile();\r\n                    const text = await file.text();\r\n                    const data = JSON.parse(text);\r\n                    companies.push({\r\n                        ...data,\r\n                        path: entry.name\r\n                    });\r\n                } catch {\r\n                    // Skip if not a company directory\r\n                }\r\n            }\r\n        }\r\n        return companies;\r\n    }\r\n\r\n    async createCompany(data: Omit<Company, 'id' | 'path'>): Promise<Company> {\r\n        if (!this.dirHandle) throw new Error('Storage not initialized');\r\n\r\n        const id = Math.random().toString(36).substr(2, 9);\r\n        const folderName = `${data.name.replace(/\\s+/g, '_')}_${id}`;\r\n\r\n        // Create directory\r\n        const companyDir = await this.dirHandle.getDirectoryHandle(folderName, { create: true });\r\n\r\n        const companyData: Company = {\r\n            id,\r\n            ...data,\r\n            path: folderName\r\n        };\r\n\r\n        // Write company metadata\r\n        const compFile = await companyDir.getFileHandle('company.json', { create: true });\r\n        const writable = await compFile.createWritable();\r\n        await writable.write(JSON.stringify(companyData, null, 2));\r\n        await writable.close();\r\n\r\n        return companyData;\r\n    }\r\n\r\n    async updateCompany(id: string, path: string, data: Partial<Omit<Company, 'id' | 'path'>>): Promise<Company> {\r\n        if (!this.dirHandle) throw new Error('Storage not initialized');\r\n\r\n        const companyDir = await this.dirHandle.getDirectoryHandle(path);\r\n        const compFile = await companyDir.getFileHandle('company.json');\r\n\r\n        // Read existing\r\n        const file = await compFile.getFile();\r\n        const text = await file.text();\r\n        const existingData = JSON.parse(text) as Company;\r\n\r\n        const updatedData: Company = {\r\n            ...existingData,\r\n            ...data,\r\n            id, // Ensure ID and path remain same\r\n            path\r\n        };\r\n\r\n        // Write back\r\n        const writable = await compFile.createWritable();\r\n        await writable.write(JSON.stringify(updatedData, null, 2));\r\n        await writable.close();\r\n\r\n        return updatedData;\r\n    }\r\n\r\n    async read<T>(filename: string, companyPath?: string): Promise<T | null> {\r\n        if (!this.dirHandle) throw new Error('Storage not initialized');\r\n\r\n        try {\r\n            let targetDir = this.dirHandle;\r\n            if (companyPath) {\r\n                targetDir = await this.dirHandle.getDirectoryHandle(companyPath);\r\n            }\r\n\r\n            const fileHandle = await targetDir.getFileHandle(filename, { create: false });\r\n            const file = await fileHandle.getFile();\r\n            const text = await file.text();\r\n            return JSON.parse(text) as T;\r\n        } catch (err) {\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            if ((err as any).name === 'NotFoundError') {\r\n                return null;\r\n            }\r\n            throw err;\r\n        }\r\n    }\r\n\r\n    async write<T>(filename: string, data: T, companyPath?: string): Promise<void> {\r\n        if (!this.dirHandle) throw new Error('Storage not initialized');\r\n\r\n        try {\r\n            let targetDir = this.dirHandle;\r\n            if (companyPath) {\r\n                targetDir = await this.dirHandle.getDirectoryHandle(companyPath, { create: true });\r\n            }\r\n\r\n            const fileHandle = await targetDir.getFileHandle(filename, { create: true });\r\n            const writable = await fileHandle.createWritable();\r\n            await writable.write(JSON.stringify(data, null, 2));\r\n            await writable.close();\r\n        } catch (err) {\r\n            console.error('Error writing file:', err);\r\n            throw err;\r\n        }\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\persistence\\PersistenceContext.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`restoreStorage` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nM:\\Projects\\MoneyArc\\src\\services\\persistence\\PersistenceContext.tsx:24:9\n  22 |     useEffect(() => {\n  23 |         console.log('PersistenceProvider: Attempting to restore storage...');\n> 24 |         restoreStorage();\n     |         ^^^^^^^^^^^^^^ `restoreStorage` accessed before it is declared\n  25 |     }, []);\n  26 |\n  27 |     const restoreStorage = async () => {\n\nM:\\Projects\\MoneyArc\\src\\services\\persistence\\PersistenceContext.tsx:27:5\n  25 |     }, []);\n  26 |\n> 27 |     const restoreStorage = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         try {\n     | ^^^^^^^^^^^^^\n> 29 |             const localProvider = new FileSystemProvider();\n     …\n     | ^^^^^^^^^^^^^\n> 41 |         return false;\n     | ^^^^^^^^^^^^^\n> 42 |     };\n     | ^^^^^^^ `restoreStorage` is declared here\n  43 |\n  44 |     const initializeStorage = async (type: StorageType) => {\n  45 |         let newProvider: StorageProvider | null = null;","line":24,"column":9,"nodeType":null,"endLine":24,"endColumn":23},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":79,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":79,"endColumn":31}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect, type ReactNode } from 'react';\r\nimport type { StorageProvider, StorageType, Company } from './types';\r\nimport { FileSystemProvider } from './FileSystemProvider';\r\n\r\ninterface PersistenceContextType {\r\n    provider: StorageProvider | null;\r\n    storageType: StorageType;\r\n    activeCompany: Company | null;\r\n    initializeStorage: (type: StorageType) => Promise<void>;\r\n    restoreStorage: () => Promise<boolean>;\r\n    selectCompany: (company: Company | null) => void;\r\n}\r\n\r\nconst PersistenceContext = createContext<PersistenceContextType | null>(null);\r\n\r\nexport function PersistenceProvider({ children }: { children: ReactNode }) {\r\n    const [provider, setProvider] = useState<StorageProvider | null>(null);\r\n    const [storageType, setStorageType] = useState<StorageType>(null);\r\n    const [activeCompany, setActiveCompany] = useState<Company | null>(null);\r\n\r\n    // Try to restore storage on mount\r\n    useEffect(() => {\r\n        console.log('PersistenceProvider: Attempting to restore storage...');\r\n        restoreStorage();\r\n    }, []);\r\n\r\n    const restoreStorage = async () => {\r\n        try {\r\n            const localProvider = new FileSystemProvider();\r\n            const restored = await localProvider.restore?.();\r\n            if (restored) {\r\n                console.log('PersistenceProvider: Storage restored successfully.');\r\n                setProvider(localProvider);\r\n                setStorageType('local');\r\n                return true;\r\n            }\r\n        } catch (e) {\r\n            console.error('PersistenceProvider: Restore failed', e);\r\n        }\r\n        console.log('PersistenceProvider: Storage not restored (normal if first run).');\r\n        return false;\r\n    };\r\n\r\n    const initializeStorage = async (type: StorageType) => {\r\n        let newProvider: StorageProvider | null = null;\r\n\r\n        if (type === 'local') {\r\n            newProvider = new FileSystemProvider();\r\n        }\r\n        // Add Cloud provider logic here later\r\n\r\n        if (newProvider) {\r\n            await newProvider.init();\r\n            if (newProvider.isReady) {\r\n                setProvider(newProvider);\r\n                setStorageType(type);\r\n            }\r\n        }\r\n    };\r\n\r\n    const selectCompany = (company: Company | null) => {\r\n        setActiveCompany(company);\r\n    };\r\n\r\n    return (\r\n        <PersistenceContext.Provider value={{\r\n            provider,\r\n            storageType,\r\n            activeCompany,\r\n            initializeStorage,\r\n            restoreStorage,\r\n            selectCompany\r\n        }}>\r\n            {children}\r\n        </PersistenceContext.Provider>\r\n    );\r\n}\r\n\r\nexport function usePersistence() {\r\n    const context = useContext(PersistenceContext);\r\n    if (!context) {\r\n        throw new Error('usePersistence must be used within a PersistenceProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\persistence\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\reports\\ExportService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1809,1812],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1809,1812],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2425,2428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2425,2428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { jsPDF } from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport * as XLSX from 'xlsx';\r\nimport type { Company } from '../persistence/types';\r\n\r\nexport class ExportService {\r\n    static exportToPDF(title: string, columns: string[], rows: (string | number)[][], company: Company | null) {\r\n        // ... existing PDF logic ...\r\n        const doc = new jsPDF();\r\n        const timestamp = new Date().toLocaleString();\r\n\r\n        // Add Header\r\n        doc.setFontSize(22);\r\n        doc.setTextColor(15, 23, 42); // slate-900\r\n        doc.text(\"MoneyArc\", 14, 20);\r\n\r\n        doc.setFontSize(10);\r\n        doc.setTextColor(100, 116, 139); // slate-500\r\n        doc.text(\"Professional Accounting Suite\", 14, 26);\r\n\r\n        // Company Details\r\n        if (company) {\r\n            doc.setFontSize(12);\r\n            doc.setTextColor(15, 23, 42);\r\n            doc.text(company.name, 14, 40);\r\n            doc.setFontSize(9);\r\n            doc.setTextColor(100, 116, 139);\r\n            doc.text(`${company.address || 'Address not set'} | GST: ${company.gstin || 'No GSTIN'}`, 14, 45);\r\n        }\r\n\r\n        // Report Title\r\n        doc.setFontSize(16);\r\n        doc.setTextColor(14, 165, 233); // cyan-500\r\n        doc.text(title.toUpperCase(), 14, 60);\r\n\r\n        doc.setFontSize(9);\r\n        doc.setTextColor(100, 116, 139);\r\n        doc.text(`Generated on: ${timestamp}`, 14, 65);\r\n\r\n        // Table\r\n        autoTable(doc, {\r\n            startY: 75,\r\n            head: [columns],\r\n            body: rows,\r\n            theme: 'striped',\r\n            headStyles: { fillColor: [15, 23, 42], fontStyle: 'bold' },\r\n            styles: { fontSize: 8, cellPadding: 3 },\r\n            alternateRowStyles: { fillColor: [248, 250, 252] }\r\n        });\r\n\r\n        // Footer\r\n        const pageCount = (doc as any).internal.getNumberOfPages();\r\n        for (let i = 1; i <= pageCount; i++) {\r\n            doc.setPage(i);\r\n            doc.setFontSize(8);\r\n            doc.setTextColor(148, 163, 184);\r\n            doc.text(`Page ${i} of ${pageCount}`, doc.internal.pageSize.getWidth() - 30, doc.internal.pageSize.getHeight() - 10);\r\n            doc.text(\"MoneyArc - Accurate. Secure. Professional.\", 14, doc.internal.pageSize.getHeight() - 10);\r\n        }\r\n\r\n        doc.save(`${title.toLowerCase().replace(/\\s+/g, '_')}_${new Date().getTime()}.pdf`);\r\n    }\r\n\r\n    static exportToExcel(title: string, columns: string[], rows: any[][]) {\r\n        const worksheetData = [columns, ...rows];\r\n        const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);\r\n        const workbook = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(workbook, worksheet, title);\r\n\r\n        XLSX.writeFile(workbook, `${title.toLowerCase().replace(/\\s+/g, '_')}_${new Date().getTime()}.xlsx`);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"M:\\Projects\\MoneyArc\\src\\services\\security\\AuditService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]